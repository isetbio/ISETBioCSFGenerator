% t_spatialCSF_mRGCExamples
%
% These are examples for t_spatialCSF that exercise the mRGC calculations.

% Examples:
%{
    % mRGCMosaic nre basic test: achromatic CSF
    t_spatialCSF('useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'spatialFreqs', [0.3 0.6 1.2 3 6 12 30 60], ...
        'nTest', 1024, ...
        'validationThresholds', [0.5112 0.2519 0.1664 0.1859 0.1833 0.1797 0.5479 1.0000]);





    % mRGCMosaic CSF: L-M,  native optics @ fovea (2x2degs)
    
    validationThresholds = [...

];
    t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0.0 0], ...
        'mosaicSizeDegs', [2 2], ...
        'stimSizeDegs', 2.3, ...
        'pixelsNum', 512, ...
        'stimulusChroma', 'red-green', ...
        'orientationDegs', 120, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'validationThresholds', validationThresholds);


t_spatialCSF(...
        'parPoolSize', '3/4', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'adaptiveOptics6MM', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0.0 0], ...
        'mosaicSizeDegs', [2 2], ...
        'stimSizeDegs', 2.3, ...
        'pixelsNum', 512, ...
        'stimulusChroma', 'red-green', ...
        'orientationDegs', 120, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'validationThresholds', validationThresholds);

    % mRGCMosaic CSF: L+M+S,  native optics @ fovea (2x2degs)

    t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0.0 0], ...
        'mosaicSizeDegs', [2 2], ...
        'stimSizeDegs', 2.3, ...
        'pixelsNum', 512, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', 120, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', validationThresholds);


    % input cone Mosaic CSF: L-M,  native optics @ fovea (2x2degs)
    validationThresholds = [
0.0056
    0.0053
    0.0051
    0.0055
    0.0056
    0.0056
    0.0056
    0.0057
    0.0057
    0.0066
    0.0069
    0.0080
    0.0096
    0.0128
    0.0144
    0.0188
    0.0367
    0.1854
    0.9750
    1.0000
];

    t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'cones', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', ~true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0.0 0], ...
        'mosaicSizeDegs', [2 2], ...
        'stimSizeDegs', 2.3, ...
        'pixelsNum', 512, ...
        'stimulusChroma', 'red-green', ...
        'orientationDegs', 120, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', validationThresholds)

% input cone Mosaic CSF: L+M+S,  native optics @ fovea (2x2degs)
    validationThresholds = [
0.0062
    0.0066
    0.0063
    0.0063
    0.0062
    0.0067
    0.0061
    0.0071
    0.0070
    0.0070
    0.0081
    0.0086
    0.0111
    0.0152
    0.0208
    0.0325
    0.0640
    0.1925
    1.0000
    1.0000
];

    t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'cones', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', ~true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0.0 0], ...
        'mosaicSizeDegs', [2 2], ...
        'stimSizeDegs', 2.3, ...
        'pixelsNum', 512, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', 120, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', validationThresholds)

 

 
    % mRGCMosaic nre test: 
    % achromatic  AO optics, drifting CSF @ fovea (1x1 degs)
    validationThresholds = [...
 0.0279
    0.0302
    0.0287
    0.0286
    0.0310
    0.0296
    0.0285
    0.0269
    0.0261
    0.0232
    0.0199
    0.0177
    0.0148
    0.0129
    0.0136
    0.0152
    0.0188
    0.0228
    0.0538
    0.1683
    ];

    t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'adaptiveOptics6MM', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0.0 0], ...
        'mosaicSizeDegs', [2 2], ...
        'stimSizeDegs', 2.3, ...
        'pixelsNum', 512, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', 120, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', validationThresholds);


validationThresholds = [...
0.0089
    0.0089
    0.0086
    0.0087
    0.0088
    0.0086
    0.0085
    0.0090
    0.0091
    0.0091
    0.0089
    0.0094
    0.0101
    0.0097
    0.0111
    0.0125
    0.0158
    0.0244
    0.0529
    0.1904
];

t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'adaptiveOptics6MM', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0 0], ...
        'mosaicSizeDegs', [2 2], ...
        'stimSizeDegs', 2.3, ...
        'pixelsNum', 512, ...
        'stimulusChroma', 'red-green', ...
        'orientationDegs', 120, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', validationThresholds);






% DIFFERENT ECCENTRICITIES, custom cone fundamentals, LUM + L-M

mRGCvalidationThresholdsAchromatic_0degs = [...
0.0636
    0.0659
    0.0638
    0.0627
    0.0639
    0.0635
    0.0600
    0.0644
    0.0544
    0.0536
    0.0481
    0.0456
    0.0497
    0.0558
    0.0689
    0.1101
    0.1847
    0.4763
    1.0000
    1.0000
];

fovealPSForientationDegs = 120;

t_spatialCSF(...
        'parPoolSize', '3/4', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0 0], ...
        'mosaicSizeDegs', [0.59 0.59], ...
        'stimSizeDegs', 1, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', fovealPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', mRGCvalidationThresholdsAchromatic_0degs);



coneValidationThresholdsAchromatic_0degs = [...
0.0157
    0.0152
    0.0149
    0.0151
    0.0155
    0.0164
    0.0160
    0.0159
    0.0157
    0.0177
    0.0202
    0.0222
    0.0264
    0.0318
    0.0516
    0.0748
    0.1462
    0.3950
    1.0000
    1.0000
];

t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'cones', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', ~true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0 0], ...
        'mosaicSizeDegs', [0.59 0.59], ...
        'stimSizeDegs', 1, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', fovealPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', coneValidationThresholdsAchromatic_0degs);


mRGCValidationThresholdsRedGreen_0degs = [...
0.0157
    0.0152
    0.0149
    0.0151
    0.0155
    0.0164
    0.0160
    0.0159
    0.0157
    0.0177
    0.0202
    0.0222
    0.0264
    0.0318
    0.0516
    0.0748
    0.1462
    0.3950
    1.0000
    1.0000
];

t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', ~true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0 0], ...
        'mosaicSizeDegs', [0.59 0.59], ...
        'stimSizeDegs', 1, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'red-green', ...
        'orientationDegs', fovealPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', mRGCValidationThresholdsRedGreen_0degs);


mRGCvalidationThresholdsAchromaticAO_0degs = [...
0.0602
    0.0656
    0.0629
    0.0636
    0.0598
    0.0625
    0.0589
    0.0540
    0.0506
    0.0451
    0.0368
    0.0328
    0.0286
    0.0286
    0.0316
    0.0349
    0.0473
    0.0811
    0.2358
];

t_spatialCSF(...
        'parPoolSize', '3/4', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'adaptiveOptics6MM', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0 0], ...
        'mosaicSizeDegs', [0.59 0.59], ...
        'stimSizeDegs', 1, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', fovealPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', mRGCvalidationThresholdsAchromaticAO_0degs);


mRGCvalidationThresholdsRedGreenAO_0degs = [...
0.0602
    0.0656
    0.0629
    0.0636
    0.0598
    0.0625
    0.0589
    0.0540
    0.0506
    0.0451
    0.0368
    0.0328
    0.0286
    0.0286
    0.0316
    0.0349
    0.0473
    0.0811
    0.2358
];

t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'adaptiveOptics6MM', ...
        'mRGCMosaicRawEccDegs', [0 0], ...
        'mRGCMosaicRawSizeDegs', [2 2], ...
        'mosaicEccDegs', [0 0], ...
        'mosaicSizeDegs', [0.59 0.59], ...
        'stimSizeDegs', 1, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'red-green', ...
        'orientationDegs', fovealPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', mRGCvalidationThresholdsRedGreenAO_0degs);



% 4 degs
parafoveal4degsPSForientationDegs = 45;

mRGCvalidationThresholdsAchromatic_4degs  = [...
0.0471
    0.0506
    0.0494
    0.0487
    0.0440
    0.0437
    0.0381
    0.0365
    0.0361
    0.0344
    0.0405
    0.0512
    0.0915
    0.1803
    0.4622
    1.0000
    1.0000
    1.0000
    1.0000
    1.0000
];

t_spatialCSF(...
        'parPoolSize', '3/4', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [-4 0], ...
        'mRGCMosaicRawSizeDegs', [3 3], ...
        'mosaicEccDegs', [-4.0 0], ...
        'mosaicSizeDegs', [2.1 2.1], ...
        'stimSizeDegs', 2.5, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', fovealPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', mRGCvalidationThresholdsAchromatic_4degs);


coneValidationThresholdsAchromatic_4degs = [...
0.0157
    0.0152
    0.0149
    0.0151
    0.0155
    0.0164
    0.0160
    0.0159
    0.0157
    0.0177
    0.0202
    0.0222
    0.0264
    0.0318
    0.0516
    0.0748
    0.1462
    0.3950
    1.0000
    1.0000
];

t_spatialCSF(...
        'parPoolSize', '3/4', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'cones', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', ~true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [-4 0], ...
        'mRGCMosaicRawSizeDegs', [3 3], ...
        'mosaicEccDegs', [-4.0 0], ...
        'mosaicSizeDegs', [2.1 2.1], ...
        'stimSizeDegs', 2.5, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', fovealPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.2), log10(120), 20), ...
        'validationThresholds', coneValidationThresholdsAchromatic_4degs);





% 7 degs

mRGCvalidationThresholds_7degs = [...
0.0450
    0.0435
    0.0455
    0.0419
    0.0460
    0.0421
    0.0422
    0.0393
    0.0398
    0.0354
    0.0312
    0.0327
    0.0345
    0.0492
    0.1038
    0.2863
    1.0000
    1.0000
    1.0000
    1.0000
];
parafoveal7degsPSForientationDegs = 

t_spatialCSF(...
        'parPoolSize', '3/4', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'mRGCs', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [-7 0], ...
        'mRGCMosaicRawSizeDegs', [4 4], ...
        'mosaicEccDegs', [-7.0 0], ...
        'mosaicSizeDegs', [3.2 3.2], ...
        'stimSizeDegs', 4.2, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', parafoveal7degsPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.05), log10(60), 20), ...
        'validationThresholds', mRGCvalidationThresholds_7degs);



coneValidationThresholds_7degs = [...
0.0093
    0.0092
    0.0089
    0.0100
    0.0096
    0.0101
    0.0100
    0.0117
    0.0127
    0.0142
    0.0212
    0.0330
    0.0598
    0.1470
    0.3777
    0.6694
    1.0000
    1.0000
    1.0000
    1.0000
];

t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'cones', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', ~true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [-7 0], ...
        'mRGCMosaicRawSizeDegs', [4 4], ...
        'mosaicEccDegs', [-7.0 0], ...
        'mosaicSizeDegs', [3.2 3.2], ...
        'stimSizeDegs', 4.2, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', parafoveal7degsPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.05), log10(60), 20), ...
        'validationThresholds', coneValidationThresholds_7degs);

coneValidationThresholds_10degs = [...
0.0093
    0.0092
    0.0089
    0.0100
    0.0096
    0.0101
    0.0100
    0.0117
    0.0127
    0.0142
    0.0212
    0.0330
    0.0598
    0.1470
    0.3777
    0.6694
    1.0000
    1.0000
    1.0000
    1.0000
];
parafoveal10degsPSForientationDegs = 

t_spatialCSF(...
        'parPoolSize', 'extreme', ...
        'useMetaContrast', true, ...
        'whichNoiseFreeNre', 'mRGCMosaic', ...
        'mRGCOutputSignalType', 'cones', ...
        'whichNoisyInstanceNre', 'Gaussian', ...
        'gaussianSigma', 0.1, ...
        'whichClassifierEngine', 'rceTemplateDistance', ...
        'useConeContrast', true, ...
        'useFixationalEMs', false, ...
        'temporalFilterValues', [], ...
        'oiPadMethod', 'zero', ...
        'visualizeEachScene', false, ...
        'visualizeEachResponse', ~true, ...
        'responseVisualizationFunction', @nreVisualizeMRGCmosaic, ...
        'maxVisualizedNoisyResponseInstances', 2, ...
        'maxVisualizedNoisyResponseInstanceStimuli', 2, ...
        'opticsType', 'loadComputeReadyRGCMosaic', ...
        'mRGCMosaicRawEccDegs', [-10 0], ...
        'mRGCMosaicRawSizeDegs', [4 4], ...
        'mosaicEccDegs', [-10.0 0], ...
        'mosaicSizeDegs', [4 4], ...
        'stimSizeDegs', 5.2, ...
        'pixelsNum', 512, ...
        'employMosaicSpecificConeFundamentals', true, ...
        'stimulusChroma', 'luminance', ...
        'orientationDegs', parafoveal10degsPSForientationDegs, ...
        'presentationMode', 'drifted', ...
        'stimDurationTemporalCycles', 1.0, ...
        'frameDurationSeconds', (1/2.5)/8, ...
        'temporalFrequencyHz', 2.5, ...
        'nTest', 1024, ...
        'psychometricCurveSamplesNum', 5, ...
        'spatialFreqs', logspace(log10(0.05), log10(60), 20), ...
        'validationThresholds', coneValidationThresholds_10degs);



%}
